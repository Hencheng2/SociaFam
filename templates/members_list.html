{% extends "base.html" %}
{% block title %}Friends{% endblock %}
{% block content %}
<!-- Redirect Prompt for Unauthenticated Users -->
{% if not current_user.is_authenticated %}
    <div class="alert alert-warning text-center" role="alert">
        Please <a href="{{ url_for('login') }}">log in</a> to view the users list.
    </div>
{% else %}
    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="alert-container mb-4">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message | safe }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Member List -->
    <div class="list-group">
        {% if members and members|length > 0 %}
            {% for member in members %}
                <div class="list-group-item list-group-item-action d-flex align-items-center mb-2 rounded-3 shadow-sm bg-light">
                    <div class="profile-pic-wrapper me-3">
                        <img src="{% if member.profilePhoto %}{{ url_for('static', filename='img/profile_photos/' + member.profilePhoto) }}{% else %}{{ url_for('static', filename='img/default_profile.png') }}{% endif %}" alt="{{ member.originalName|default(member.username) }} Profile Photo" class="img-fluid rounded-circle" style="width: 50px; height: 50px;">
                    </div>
                    <div class="flex-grow-1">
                        <h5 class="mb-0">{{ member.originalName|default(member.username) }}</h5>
                    </div>
                    <a href="{{ url_for('view_member', member_id=member.id) }}" class="btn btn-primary btn-sm">View Profile</a>
                </div>
            {% endfor %}
        {% else %}
            <p class="text-center text-muted mt-3">No users found.</p>
        {% endif %}
    </div>
{% endif %}

{% endblock %}
